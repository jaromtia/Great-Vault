#tool-blue/network 

Sniffer Mode

Logger Mode

IDS/IPS Mode 

## Snort Rule Syntax

Snort Rule:
![[snort-rule-syntax-example.png]]

## Snort Rule examples
Potential .exe download over HTTP
`alert tcp any 80 -> any any (msg:"[message]"; http_header; sid:[sid-#]; rev:1;`

Detecting based off of magic byte
`alert ttcp any 80 -> any any (msg:"[message]"; file_date; content:"|4D 5A|"; depth: 2; sid[#]; rev:1;`

Detect SSLoad activity via User-Agent
`alert tcp any any -> any any (msg:"[message]"; content:"User-Agent":SSLoad/1.1"; http_header; nocase; sid:[#]; rev:1;`

Detect potential brute force attack
`alert tcp any any -> any 22 (msg:"[message]"; flow:to_server,established; threshold:type threshold, track by_src, count 5 , seconds 30; sid:[#]; rev:1; `


## Runnning rules against pcap

Detect which rules match within pcap files
`sudo snort -c /etc/snort/snort.conf -q -r [pcapfile] -A console`

Provide hex/ascii of packets
`sudo snort -r /var/log/snort/[snort.log] -q -d` 

`snort -c /etc/snort/snort.conf -A console -r /path/to/snort_challenge.pcap -K ascii -l /path/to/logs -q`
- **`-c /etc/snort/snort.conf`**: This specifies the path to the Snort configuration file. You need to ensure that your `snort.conf` includes the custom rule file (`custom.rules`).
- **`-A console`**: This specifies that Snort should output alerts to the console. You can change this to `-A file` if you want alerts to be saved in a log file.
- **`-r /path/to/snort_challenge.pcap`**: This is the path to your PCAP file (`snort_challenge.pcap`).
- **`-K ascii`**: This option specifies that Snort should use ASCII format for the output.
- **`-l /path/to/logs`**: This specifies the directory where Snort will log the alerts.
- - **`-q`**: Runs Snort in **quiet mode**, which suppresses most of the verbose output (packet-level information, etc.). You will only see the alerts generated by the rule.